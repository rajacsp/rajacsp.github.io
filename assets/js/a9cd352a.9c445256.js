"use strict";(self.webpackChunkdeep_notes=self.webpackChunkdeep_notes||[]).push([[11739],{871928:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"devops/docker/others","title":"Others","description":"Dive","source":"@site/docs/devops/docker/others.md","sourceDirName":"devops/docker","slug":"/devops/docker/others","permalink":"/devops/docker/others","draft":false,"unlisted":false,"editUrl":"https://github.com/rajacsp/rajacsp.github.io/tree/master/docs/devops/docker/others.md","tags":[],"version":"current","lastUpdatedBy":"Raja CSP Raman","lastUpdatedAt":1765093505000,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Networking","permalink":"/devops/docker/networking"},"next":{"title":"Service Configuration Reference","permalink":"/devops/docker/service-configuration-reference"}}');var r=s(474848),t=s(28453);const i={},c="Others",a={},l=[{value:"Dive",id:"dive",level:2},{value:"Logging / aws logs / driver",id:"logging--aws-logs--driver",level:2},{value:"GELF",id:"gelf",level:2},{value:"Security",id:"security",level:2},{value:"overlayfs",id:"overlayfs",level:2},{value:"Swap / Memory / Resources",id:"swap--memory--resources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"others",children:"Others"})}),"\n",(0,r.jsx)(n.h2,{id:"dive",children:"Dive"}),"\n",(0,r.jsx)(n.p,{children:"An amazing tool for inspecting Docker images."}),"\n",(0,r.jsx)(n.p,{children:"A tool for exploring a docker image, layer contents, and discovering ways to shrink your Docker image size."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/wagoodman/dive",children:"https://github.com/wagoodman/dive"})}),"\n",(0,r.jsx)(n.h2,{id:"logging--aws-logs--driver",children:"Logging / aws logs / driver"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'// /etc/docker/daemon.json\n{\n    "log-driver": "json-file",\n    "log-opts": {\n    "mode": "non-blocking",\n    "max-buffer-size": "1m",\n    "max-size": "10m",\n    "max-file": "3",\n    "compress": "true"\n    }\n}\n\n// sudo vim /etc/docker/daemon.json\n{\n    "log-driver": "awslogs",\n    "log-opts": {\n    "awslogs-region": "us-west-2",\n    "awslogs-group": "prodec2"\n    }\n}\n\n// sudo service docker restart\n'})}),"\n",(0,r.jsx)(n.p,{children:"Add push-cloudwatch-logs IAM policy in ec2 instances"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Action": [\n                "logs:CreateLogStream",\n                "logs:PutLogEvents"\n            ],\n            "Effect": "Allow",\n            "Resource": "*"\n        }\n    ]\n}\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'docker run --log-driver=awslogs --log-opt awslogs-region=us-west-2 --log-opt awslogs-group=prodec2 hello-world\n\n# Add this logging configuration to docker-compose for all services\nlogging:\n    options:\n        tag: "{% raw %}{{.Name}} {{.ImageName}}{% endraw %}"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/config/containers/logging/awslogs",children:"https://docs.docker.com/config/containers/logging/awslogs"})}),"\n",(0,r.jsx)(n.h2,{id:"gelf",children:"GELF"}),"\n",(0,r.jsx)(n.p,{children:"Structured events from anywhere. Compressed and chunked."}),"\n",(0,r.jsx)(n.p,{children:"The Graylog Extended Log Format (GELF) is a log format that avoids the shortcomings of classic plain syslog:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Limited to length of 1024 bytes -- Not much space for payloads like backtraces"}),"\n",(0,r.jsx)(n.li,{children:"No data types in structured syslog. You don't know what is a number and what is a string."}),"\n",(0,r.jsx)(n.li,{children:"The RFCs are strict enough but there are so many syslog dialects out there that you cannot possibly parse all of them."}),"\n",(0,r.jsx)(n.li,{children:"No compression"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"http://docs.graylog.org/en/3.0/pages/gelf.html",children:"http://docs.graylog.org/en/3.0/pages/gelf.html"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/config/containers/logging/gelf",children:"https://docs.docker.com/config/containers/logging/gelf"})}),"\n",(0,r.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://www.stackrox.com/post/2019/09/docker-security-101",children:"https://www.stackrox.com/post/2019/09/docker-security-101"})}),"\n",(0,r.jsx)(n.h2,{id:"overlayfs",children:"overlayfs"}),"\n",(0,r.jsx)(n.p,{children:'Overlay filesystems, also known as "union filesystems" or "union mounts" let you mount a filesystem using 2 directories: a "lower" directory, and an "upper" directory.'}),"\n",(0,r.jsx)(n.p,{children:"Basically:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"the lower directory of the filesystem is read-only"}),"\n",(0,r.jsx)(n.li,{children:"the upper directory of the filesystem can be both read to and written from"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"When a process reads a file, the overlayfs filesystem driver looks in the upper directory and reads the file from there if it's present. Otherwise, it looks in the lower directory."}),"\n",(0,r.jsx)(n.p,{children:"When a process writes a file, overlayfs will just write it to the upper directory."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image",src:s(370498).A+"",width:"999",height:"636"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://jvns.ca/blog/2019/11/18/how-containers-work--overlayfs",children:"https://jvns.ca/blog/2019/11/18/how-containers-work--overlayfs"})}),"\n",(0,r.jsx)(n.h2,{id:"swap--memory--resources",children:"Swap / Memory / Resources"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"docker info"})}),"\n",(0,r.jsx)(n.p,{children:"WARNING: No swap limit support"}),"\n",(0,r.jsx)(n.p,{children:"This warning does not occur on RPM-based systems, which enable these capabilities by default."}),"\n",(0,r.jsx)(n.p,{children:"If you don't need these capabilities, you can ignore the warning. You can enable these capabilities on Ubuntu or Debian by following these instructions. Memory and swap accounting incur an overhead of about 1% of the total available memory and a 10% overall performance degradation, even if Docker is not running."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/engine/install/linux-postinstall/#your-kernel-does-not-support-cgroup-swap-limit-capabilities",children:"https://docs.docker.com/engine/install/linux-postinstall/#your-kernel-does-not-support-cgroup-swap-limit-capabilities"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://docs.docker.com/config/containers/resource_constraints",children:"https://docs.docker.com/config/containers/resource_constraints"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},370498:(e,n,s)=>{s.d(n,{A:()=>o});const o=s.p+"assets/images/DevOps-Docker-Others-image1-dc7c000e1fe31e99d45d53d3414c12b4.jpg"},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var o=s(296540);const r={},t=o.createContext(r);function i(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);